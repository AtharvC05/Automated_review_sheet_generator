<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Review-I Form</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/common-styles.css') }}">
</head>
<body>
    <!-- Fixed Header with Centered Title and Right-Aligned Button -->
    <div class="page-header">
        <div class="header-left"></div>
        <div class="header-center">
            <h1>Project Review - I</h1>
        </div>
        <div class="menu-container">
        <button class="menu-toggle" onclick="toggleMenu()">
            <span class="menu-line"></span>
            <span class="menu-line"></span>
            <span class="menu-line"></span>
        </button>
        
         <div class="menu-dropdown" id="menuDropdown">
            <a href="/data-manager" class="menu-item">
                <span class="icon">üóÑÔ∏è</span>
                Database Manager
            </a>
            
            <a href="/scheduler" class="menu-item current">
                <span class="icon">üìÖ</span>
                Review Scheduler
            </a>
            
            <div class="menu-divider"></div>
            
            <a href="/review1" class="menu-item">
                <span class="icon">üìù</span>
                Review I - Scope
            </a>
            
            <a href="/review2" class="menu-item">
                <span class="icon">üîç</span>
                Review II - Design
            </a>
            
            <a href="/review3" class="menu-item">
                <span class="icon">‚öôÔ∏è</span>
                Review III - Implementation
            </a>
            
            <a href="/review4" class="menu-item">
                <span class="icon">üß™</span>
                Review IV - Testing
            </a>
            
            <a href="/review5" class="menu-item">
                <span class="icon">üìä</span>
                Review V - Final
            </a>
            
            <div class="menu-divider"></div>
            
            <a href="/" class="menu-item">
                <span class="icon">üè†</span>
                Home
            </a>
        </div>
    </div>

    <div class="content-wrapper">
        <form id="form-data">
            <!-- Removed the duplicate h2 title here -->
            
            <label for="group_id">Group ID:</label>
            <input type="text" id="group_id" name="group_id" required placeholder="eg: BIA-01">

            <label for="date">Date:</label>
            <input type="date" id="date" name="date" required>

            <div class="section">
                <h3>REVIEW - I CHECKLIST : FINALIZATION OF SCOPE</h3>
                <div class="question">
                    <label>1. Is the statement short and concise (10-20 words maximum)?</label>
                    <div class="radio-group">
                        <input type="radio" id="ps1-yes" name="que_1.1.1" value="Y" required><label for="ps1-yes">Yes</label>
                        <input type="radio" id="ps1-no" name="que_1.1.1" value="N"><label for="ps1-no">No</label>
                        <input type="radio" id="ps1-na" name="que_1.1.1" value="NA"><label for="ps1-na">N/A</label>
                        <input type="radio" id="ps1-nc" name="que_1.1.1" value="NC"><label for="ps1-nc">NC</label>
                    </div>
                </div>

                <div class="question">
                    <label>2. Does the statement give clear indication about what your project will accomplish?</label>
                    <div class="radio-group">
                        <input type="radio" id="ps2-yes" name="que_1.1.2" value="Y" required><label for="ps2-yes">Yes</label>
                        <input type="radio" id="ps2-no" name="que_1.1.2" value="N"><label for="ps2-no">No</label>
                        <input type="radio" id="ps2-na" name="que_1.1.2" value="NA"><label for="ps2-na">N/A</label>
                        <input type="radio" id="ps2-nc" name="que_1.1.2" value="NC"><label for="ps2-nc">NC</label>
                    </div>
                </div>
                
                <div class="question">
                    <label>3. Can a person who is not familiar with the project understand scope of the project by reading the Project Problem Statement?</label>
                    <div class="radio-group">
                        <input type="radio" id="ps3-yes" name="que_1.1.3" value="Y" required><label for="ps3-yes">Yes</label>
                        <input type="radio" id="ps3-no" name="que_1.1.3" value="N"><label for="ps3-no">No</label>
                        <input type="radio" id="ps3-na" name="que_1.1.3" value="NA"><label for="ps3-na">N/A</label>
                        <input type="radio" id="ps3-nc" name="que_1.1.3" value="NC"><label for="ps3-nc">NC</label>
                    </div>
                </div>
            </div>

            <div class="section">
                <h3>REQUIREMENT: SCOPE AND OBJECTIVES</h3>
                <div class="question">
                    <label>a. Are all aspects of the requirements document addressed in the design?</label>
                    <div class="radio-group">
                        <input type="radio" id="req1-yes" name="que_1.2.1" value="Y" required><label for="req1-yes">Yes</label>
                        <input type="radio" id="req1-no" name="que_1.2.1" value="N"><label for="req1-no">No</label>
                        <input type="radio" id="req1-na" name="que_1.2.1" value="NA"><label for="req1-na">N/A</label>
                        <input type="radio" id="req1-nc" name="que_1.2.1" value="NC"><label for="req1-nc">NC</label>
                    </div>
                </div>

                <div class="question">
                    <label>b. Is the architecture / block diagram well defined and understood?</label>
                    <div class="radio-group">
                        <input type="radio" id="req2-yes" name="que_1.2.2" value="Y" required><label for="req2-yes">Yes</label>
                        <input type="radio" id="req2-no" name="que_1.2.2" value="N"><label for="req2-no">No</label>
                        <input type="radio" id="req2-na" name="que_1.2.2" value="NA"><label for="req2-na">N/A</label>
                        <input type="radio" id="req2-nc" name="que_1.2.2" value="NC"><label for="req2-nc">NC</label>
                    </div>
                </div>
                
                <div class="question">
                    <label>c. The project's objective of study (what product, process, resource etc.) is being addressed?</label>
                    <div class="radio-group">
                        <input type="radio" id="req3-yes" name="que_1.2.3" value="Y" required><label for="req3-yes">Yes</label>
                        <input type="radio" id="req3-no" name="que_1.2.3" value="N"><label for="req3-no">No</label>
                        <input type="radio" id="req3-na" name="que_1.2.3" value="NA"><label for="req3-na">N/A</label>
                        <input type="radio" id="req3-nc" name="que_1.2.3" value="NC"><label for="req3-nc">NC</label>
                    </div>
                </div>
                
                <div class="question">
                    <label>d. The project's purpose: is the purpose of project addressed properly (why it's being pursued: to evaluate, reduce, increase, etc.)?</label>
                    <div class="radio-group">
                        <input type="radio" id="req4-yes" name="que_1.2.4" value="Y" required><label for="req4-yes">Yes</label>
                        <input type="radio" id="req4-no" name="que_1.2.4" value="N"><label for="req4-no">No</label>
                        <input type="radio" id="req4-na" name="que_1.2.4" value="NA"><label for="req4-na">N/A</label>
                        <input type="radio" id="req4-nc" name="que_1.2.4" value="NC"><label for="req4-nc">NC</label>
                    </div>
                </div>
                
                <div class="question">
                    <label>e. The project's viewpoint: Is the project's viewpoint understood? (Who is the project's end user)?</label>
                    <div class="radio-group">
                        <input type="radio" id="req5-yes" name="que_1.2.5" value="Y" required><label for="req5-yes">Yes</label>
                        <input type="radio" id="req5-no" name="que_1.2.5" value="N"><label for="req5-no">No</label>
                        <input type="radio" id="req5-na" name="que_1.2.5" value="NA"><label for="req5-na">N/A</label>
                        <input type="radio" id="req5-nc" name="que_1.2.5" value="NC"><label for="req5-nc">NC</label>
                    </div>
                </div>
                
                <div class="question">
                    <label>f. Is the project goal statement in alignment with the sponsoring organization's business goals and mission?</label>
                    <div class="radio-group">
                        <input type="radio" id="req6-yes" name="que_1.2.6" value="Y" required><label for="req6-yes">Yes</label>
                        <input type="radio" id="req6-no" name="que_1.2.6" value="N"><label for="req6-no">No</label>
                        <input type="radio" id="req6-na" name="que_1.2.6" value="NA"><label for="req6-na">N/A</label>
                        <input type="radio" id="req6-nc" name="que_1.2.6" value="NC"><label for="req6-nc">NC</label>
                    </div>
                </div>
            </div>

            <div class="section">
                <h3>ANALYSIS</h3>
                <div class="question">
                    <label>1. Is information domain analysis complete, consistent and accurate?</label>
                    <div class="radio-group">
                        <input type="radio" id="ana1-yes" name="que_1.3.1" value="Y" required><label for="ana1-yes">Yes</label>
                        <input type="radio" id="ana1-no" name="que_1.3.1" value="N"><label for="ana1-no">No</label>
                        <input type="radio" id="ana1-na" name="que_1.3.1" value="NA"><label for="ana1-na">N/A</label>
                        <input type="radio" id="ana1-nc" name="que_1.3.1" value="NC"><label for="ana1-nc">NC</label>
                    </div>
                </div>

                <div class="question">
                    <label>2. Is problem statement categorized in identified area and targeted towards specific area therein?</label>
                    <div class="radio-group">
                        <input type="radio" id="ana2-yes" name="que_1.3.2" value="Y" required><label for="ana2-yes">Yes</label>
                        <input type="radio" id="ana2-no" name="que_1.3.2" value="N"><label for="ana2-no">No</label>
                        <input type="radio" id="ana2-na" name="que_1.3.2" value="NA"><label for="ana2-na">N/A</label>
                        <input type="radio" id="ana2-nc" name="que_1.3.2" value="NC"><label for="ana2-nc">NC</label>
                    </div>
                </div>
                
                <div class="question">
                    <label>3. Are external and internal interfaces properly defined?</label>
                    <div class="radio-group">
                        <input type="radio" id="ana3-yes" name="que_1.3.3" value="Y" required><label for="ana3-yes">Yes</label>
                        <input type="radio" id="ana3-no" name="que_1.3.3" value="N"><label for="ana3-no">No</label>
                        <input type="radio" id="ana3-na" name="que_1.3.3" value="NA"><label for="ana3-na">N/A</label>
                        <input type="radio" id="ana3-nc" name="que_1.3.3" value="NC"><label for="ana3-nc">NC</label>
                    </div>
                </div>
                
                <div class="question">
                    <label>4. Does the Use Case Model properly reflect the actors and their roles and responsibilities?</label>
                    <div class="radio-group">
                        <input type="radio" id="ana4-yes" name="que_1.3.4" value="Y" required><label for="ana4-yes">Yes</label>
                        <input type="radio" id="ana4-no" name="que_1.3.4" value="N"><label for="ana4-no">No</label>
                        <input type="radio" id="ana4-na" name="que_1.3.4" value="NA"><label for="ana4-na">N/A</label>
                        <input type="radio" id="ana4-nc" name="que_1.3.4" value="NC"><label for="ana4-nc">NC</label>
                    </div>
                </div>
                
                <div class="question">
                    <label>5. Are all requirements traceable to system level?</label>
                    <div class="radio-group">
                        <input type="radio" id="ana5-yes" name="que_1.3.5" value="Y" required><label for="ana5-yes">Yes</label>
                        <input type="radio" id="ana5-no" name="que_1.3.5" value="N"><label for="ana5-no">No</label>
                        <input type="radio" id="ana5-na" name="que_1.3.5" value="NA"><label for="ana5-na">N/A</label>
                        <input type="radio" id="ana5-nc" name="que_1.3.5" value="NC"><label for="ana5-nc">NC</label>
                    </div>
                </div>
                
                <div class="question">
                    <label>6. Is similar type of methodology / model used for existing work?</label>
                    <div class="radio-group">
                        <input type="radio" id="ana6-yes" name="que_1.3.6" value="Y" required><label for="ana6-yes">Yes</label>
                        <input type="radio" id="ana6-no" name="que_1.3.6" value="N"><label for="ana6-no">No</label>
                        <input type="radio" id="ana6-na" name="que_1.3.6" value="NA"><label for="ana6-na">N/A</label>
                        <input type="radio" id="ana6-nc" name="que_1.3.6" value="NC"><label for="ana6-nc">NC</label>
                    </div>
                </div>
                
                <div class="question">
                    <label>7. Are requirements consistent with schedule, resources and budget?</label>
                    <div class="radio-group">
                        <input type="radio" id="ana7-yes" name="que_1.3.7" value="Y" required><label for="ana7-yes">Yes</label>
                        <input type="radio" id="ana7-no" name="que_1.3.7" value="N"><label for="ana7-no">No</label>
                        <input type="radio" id="ana7-na" name="que_1.3.7" value="NA"><label for="ana7-na">N/A</label>
                        <input type="radio" id="ana7-nc" name="que_1.3.7" value="NC"><label for="ana7-nc">NC</label>
                    </div>
                </div>
            </div>

            <div class="table-responsive">
                <h2>STUDENT PERFORMANCE EVALUATION</h2>
                
                <table>


                    <thead>
                        <tr>
                            <th rowspan="2">Particulars</th>
                            <th colspan="4">Marks (25M) Group Members</th>
                        </tr>
                        <tr>
                            <th>1</th>
                            <th>2</th>
                            <th>3</th>
                            <th>4</th>
                        </tr>
                    </thead>

                   
                <tbody>
                        <tr>
                            <td>1 Understanding background and Topic (2M)</td>
                            <td><input type="number" name="1.1.1" class="marks" data-member="1" max="2" min="0"></td>
                            <td><input type="number" name="1.2.1" class="marks" data-member="2" max="2" min="0"></td>
                            <td><input type="number" name="1.3.1" class="marks" data-member="3" max="2" min="0"></td>
                            <td><input type="number" name="1.4.1" class="marks" data-member="4" max="2" min="0"></td>
                        </tr>
                        <tr>
                            <td>2.Specifies Project Scope and Objective (2M)</td>
                            <td><input type="number" name="1.1.2" class="marks" data-member="1" max="2" min="0"></td>
                            <td><input type="number" name="1.2.2" class="marks" data-member="2" max="2" min="0"></td>
                            <td><input type="number" name="1.3.2" class="marks" data-member="3" max="2" min="0"></td>
                            <td><input type="number" name="1.4.2" class="marks" data-member="4" max="2" min="0"></td>
                        </tr>
                        <tr>
                            <td>3.Literature Survey (5m)</td>
                            <td><input type="number" name="1.1.3" class="marks" data-member="1" max="5" min="0"></td>
                            <td><input type="number" name="1.2.3" class="marks" data-member="2" max="5" min="0"></td>
                            <td><input type="number" name="1.3.3" class="marks" data-member="3" max="5" min="0"></td>
                            <td><input type="number" name="1.4.3" class="marks" data-member="4" max="5" min="0"></td>
                        </tr>
                        <tr>
                            <td>4.Project Planning (4m)</td>
                            <td><input type="number" name="1.1.4" class="marks" data-member="1" max="4" min="0"></td>
                            <td><input type="number" name="1.2.4" class="marks" data-member="2" max="4" min="0"></td>
                            <td><input type="number" name="1.3.4" class="marks" data-member="3" max="4" min="0"></td>
                            <td><input type="number" name="1.4.4" class="marks" data-member="4" max="4" min="0"></td>
                        </tr>
                        <tr>
                            <td>5.Contribution of the Student (4m)</td>
                            <td><input type="number" name="1.1.5" class="marks" data-member="1" max="4" min="0"></td>
                            <td><input type="number" name="1.2.5" class="marks" data-member="2" max="4" min="0"></td>
                            <td><input type="number" name="1.3.5" class="marks" data-member="3" max="4" min="0"></td>
                            <td><input type="number" name="1.4.5" class="marks" data-member="4" max="4" min="0"></td>
                        </tr>
                        <tr>
                            <td>6.Presentation Skills (4M)</td>
                            <td><input type="number" name="1.1.6" class="marks" data-member="1" max="4" min="0"></td>
                            <td><input type="number" name="1.2.6" class="marks" data-member="2" max="4" min="0"></td>
                            <td><input type="number" name="1.3.6" class="marks" data-member="3" max="4" min="0"></td>
                            <td><input type="number" name="1.4.6" class="marks" data-member="4" max="4" min="0"></td>
                        </tr>
                        <tr>
                            <td>7.Question and Answer (4M)</td>
                            <td><input type="number" name="1.1.7" class="marks" data-member="1" max="4" min="0"></td>
                            <td><input type="number" name="1.2.7" class="marks" data-member="2" max="4" min="0"></td>
                            <td><input type="number" name="1.3.7" class="marks" data-member="3" max="4" min="0"></td>
                            <td><input type="number" name="1.4.7" class="marks" data-member="4" max="4" min="0"></td>
                        </tr>
                        <tr>
                            <td>Total (25M)</td>
                            <td><input type="number" name="1.1.s1" class="total" readonly></td>
                            <td><input type="number" name="1.2.s1" class="total" readonly></td>
                            <td><input type="number" name="1.3.s1" class="total" readonly></td>
                            <td><input type="number" name="1.4.s1" class="total" readonly></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="comment-box">
                <label for="comments">Comments:</label>
                <textarea id="comments" name="c1"></textarea>
            </div>
            
            <div class="button-group">
                <button type="button" id="generate-pdf" onclick="generatePDF()">Generate PDF</button>
                <button type="button" id="next-review" onclick="nextReview()">Next Review</button>
            </div>
        </form>
    </div>

   <script>
        // Function to calculate totals
        function calculateTotals() {
            for (let i = 1; i <= 4; i++) {
                let total = 0;
                document.querySelectorAll(`.marks[data-member="${i}"]`).forEach(input => {
                    total += parseFloat(input.value) || 0;
                });
                document.querySelector(`.total[name="1.${i}.s1"]`).value = total;
            }
        }

        // Add input event listeners to all mark input fields
        document.querySelectorAll('.marks').forEach(input => {
            input.addEventListener('input', calculateTotals);
            input.addEventListener('change', function() {
                const max = parseFloat(this.getAttribute('max')) || Infinity;
                if (parseFloat(this.value) > max) {
                    this.value = max;
                }
                calculateTotals(); // Recalculate totals after change
            });
        });

        // Validate required form fields
        function validateForm() {
            let isValid = true;
            const requiredFields = ['group_id', 'date'];
            
            requiredFields.forEach(field => {
                const element = document.getElementById(field);
                if (element && !element.value.trim()) {
                    element.classList.add('error');
                    isValid = false;
                } else if (element) {
                    element.classList.remove('error');
                }
            });

            if (!isValid) {
                alert('Please fill all required fields');
            }

            return isValid;
        }

        // Generate PDF function (FIXED)
        async function generatePDF() {
            if (!validateForm()) return;

            try {
                const submitBtn = document.getElementById('generate-pdf');
                submitBtn.disabled = true;
                submitBtn.textContent = 'Generating PDF...';

                const formData = new FormData(document.getElementById('form-data'));
                const response = await fetch('/generate-pdf-review1', {
                    method: 'POST',
                    body: JSON.stringify(Object.fromEntries(formData)),
                    headers: { 'Content-Type': 'application/json' }
                });

                if (!response.ok) {
                    throw new Error(await response.text());
                }

                // Handle PDF download
                const blob = await response.blob();
                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'Review-I_Form.pdf';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(url);

            } catch (error) {
                console.error('PDF generation failed:', error);
                alert(`Failed to generate PDF: ${error.message}`);
            } finally {
                const submitBtn = document.getElementById('generate-pdf');
                if (submitBtn) {
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'Generate PDF';
                }
            }
        }

        // Navigation to next review
        function nextReview() {
            // Save form data to sessionStorage (better for temporary data)
            const formData = new FormData(document.getElementById('form-data'));
            const data = Object.fromEntries(formData.entries());
            sessionStorage.setItem('review1_data', JSON.stringify(data));
            
            // Redirect through Flask route
            window.location.href = '/review2';  // Changed to review2 for proper flow
        }

        // Load saved data if coming back to this form
        document.addEventListener('DOMContentLoaded', function() {
            const savedData = sessionStorage.getItem('review1_data');
            if (savedData) {
                const data = JSON.parse(savedData);
                // Implement form field population logic here if needed
            }
            calculateTotals(); // Initialize totals
        });
        

// Header hide/show on scroll functionality
let lastScrollTop = 0;
let scrollThreshold = 5; // Minimum scroll distance to trigger hide/show
let isHeaderVisible = true;

function handleScroll() {
    const header = document.querySelector('.page-header');
    const currentScrollTop = window.pageYOffset || document.documentElement.scrollTop;
    
    // Check if we've scrolled enough to warrant a change
    if (Math.abs(currentScrollTop - lastScrollTop) < scrollThreshold) {
        return;
    }
    
    // Scrolling down - hide header
    if (currentScrollTop > lastScrollTop && currentScrollTop > 100 && isHeaderVisible) {
        header.classList.add('hidden');
        isHeaderVisible = false;
    }
    // Scrolling up - show header
    else if (currentScrollTop < lastScrollTop && !isHeaderVisible) {
        header.classList.remove('hidden');
        isHeaderVisible = true;
    }
    
    // Add scrolled class for backdrop effect when scrolled past header height
    if (currentScrollTop > 80) {
        header.classList.add('scrolled');
    } else {
        header.classList.remove('scrolled');
    }
    
    lastScrollTop = currentScrollTop;
}

// Throttle scroll events for better performance
let scrollTimer = null;
function throttledScroll() {
    if (scrollTimer) return;
    
    scrollTimer = setTimeout(() => {
        handleScroll();
        scrollTimer = null;
    }, 10);
}

// Add scroll event listener when DOM is loaded
document.addEventListener('DOMContentLoaded', function() {
    // Your existing DOMContentLoaded code...
    const savedData = sessionStorage.getItem('review1_data');
    if (savedData) {
        const data = JSON.parse(savedData);
        // Implement form field population logic here if needed
    }
    calculateTotals(); // Initialize totals
    
    // Add scroll listener for header hide/show
    window.addEventListener('scroll', throttledScroll, { passive: true });
});

        
    </script>
     <script>
        let menuOpen = false;

        function toggleMenu() {
            const menuToggle = document.querySelector('.menu-toggle');
            const menuDropdown = document.getElementById('menuDropdown');
            
            menuOpen = !menuOpen;
            
            if (menuOpen) {
                menuToggle.classList.add('active');
                menuDropdown.classList.add('show');
            } else {
                menuToggle.classList.remove('active');
                menuDropdown.classList.remove('show');
            }
        }

        // Close menu when clicking outside
        document.addEventListener('click', function(event) {
            const menuContainer = document.querySelector('.menu-container');
            
            if (!menuContainer.contains(event.target) && menuOpen) {
                toggleMenu();
            }
        });

        // Close menu when pressing Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape' && menuOpen) {
                toggleMenu();
            }
        });

        // Highlight current page
        document.addEventListener('DOMContentLoaded', function() {
            const currentPath = window.location.pathname;
            const menuItems = document.querySelectorAll('.menu-item');
            
            menuItems.forEach(item => {
                if (item.getAttribute('href') === currentPath) {
                    item.classList.add('current');
                }
            });
        });
    </script>
</body>
</html>
